<!DOCTYPE html>
<html>
<head>
    <title>数据可视化交互页面</title>
    <style>
        body {
            background-color: #FFFDD0;
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        .chart-container {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            gap: 20px;
        }
        .chart-wrapper {
            flex: 2;
        }
        .data-editor {
            flex: 1;
            background-color: #FFF9E6;
            padding: 15px;
            border-radius: 6px;
            border-left: 1px solid #D2B48C;
        }
        .data-input {
            margin-bottom: 10px;
        }
        .data-input label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #5C4033;
        }
        .data-input input, .data-input textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #D2B48C;
            border-radius: 4px;
        }
        .update-btn {
            background-color: #A78AFF;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }
        .update-btn:hover {
            background-color: #8C6BFF;
        }
        h1, h2 {
            color: #5C4033;
        }
        .tab {
            overflow: hidden;
            border: 1px solid #D2B48C;
            background-color: #F5DEB3;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        .tab button {
            background-color: inherit;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 12px 16px;
            transition: 0.3s;
            font-size: 16px;
        }
        .tab button:hover {
            background-color: #D2B48C;
        }
        .tab button.active {
            background-color: #D2B48C;
        }
        .tabcontent {
            display: none;
            animation: fadeEffect 0.5s;
        }
        @keyframes fadeEffect {
            from {opacity: 0;}
            to {opacity: 1;}
        }
        
        .color-picker {
            background-color: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border-left: 6px solid #A78AFF;
        }
        .color-picker h3 {
            margin-top: 0;
            color: #5C4033;
            margin-bottom: 15px;
        }
        .color-options {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }
        .color-btn {
            padding: 10px 20px;
            border: 2px solid #D2B48C;
            border-radius: 25px;
            background: white;
            color: #5C4033;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .color-btn:hover {
            background: #F5DEB3;
        }
        .color-btn.active {
            background: #A78AFF;
            color: white;
            border-color: #8C6BFF;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script>
        // 备用ECharts加载方案
        function loadECharts() {
            if (typeof echarts === 'undefined') {
                // 如果主CDN失败，尝试备用CDN
                const fallbackScript = document.createElement('script');
                fallbackScript.src = 'https://fastly.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js';
                fallbackScript.onload = initCharts;
                document.head.appendChild(fallbackScript);
            } else {
                initCharts();
            }
        }
        
        function initCharts() {
            if (typeof echarts === 'undefined') {
                console.error('ECharts库加载失败，请检查网络连接');
                return;
            }
            
            // 原有的图表初始化代码
            lineChart = echarts.init(document.getElementById('lineChart'));
            barChart = echarts.init(document.getElementById('barChart'));

            lineChart.setOption({
                title: { text: '未来15天最高气温和最低气温' },
                xAxis: { data: Array.from({length: 15}, (_, i) => i+4) },
                yAxis: {},
                series: [
                    { name: '最高气温', type: 'line', data: [32,33,34,34,33,31,30,29,30,29,26,23,21,25,31] },
                    { name: '最低气温', type: 'line', data: [19,19,20,22,22,21,22,16,18,18,17,14,15,16,16] }
                ]
            });

            barChart.setOption({
                title: { text: '2013-2019财年阿里巴巴GMV' },
                xAxis: { data: ["FY2013","FY2014","FY2015","FY2016","FY2017","FY2018","FY2019"] },
                yAxis: {},
                series: [{ type: 'bar', data: [10770,16780,24440,30920,37670,48200,57270] }]
            });
        }
    </script>
</head>
<body>
    <div class="color-picker">
        <h3>配色方案选择</h3>
        <div class="color-options">
            <button class="color-btn active" onclick="changeColorTheme('default')">默认配色</button>
            <button class="color-btn" onclick="changeColorTheme('dark')">深色主题</button>
            <button class="color-btn" onclick="changeColorTheme('blue')">蓝色主题</button>
            <button class="color-btn" onclick="changeColorTheme('green')">绿色主题</button>
            <button class="color-btn" onclick="changeColorTheme('purple')">紫色主题</button>
        </div>
    </div>
    
    <h1>数据可视化交互展示</h1>
    
    <div class="tab">
        <button class="tablinks active" onclick="openChart(event, 'line')">折线图</button>
        <button class="tablinks" onclick="openChart(event, 'bar')">柱形图</button>
    </div>

    <div id="line" class="tabcontent" style="display: block;">
        <div class="chart-container">
            <div class="chart-wrapper">
                <h2>未来15天最高气温和最低气温</h2>
                <div id="lineChart" style="width: 100%; height: 500px;"></div>
            </div>
            <div class="data-editor">
                <h3>数据编辑</h3>
                <div class="data-input">
                    <label for="lineMaxTemp">最高气温:</label>
                    <textarea id="lineMaxTemp" rows="3">32,33,34,34,33,31,30,29,30,29,26,23,21,25,31</textarea>
                </div>
                <div class="data-input">
                    <label for="lineMinTemp">最低气温:</label>
                    <textarea id="lineMinTemp" rows="3">19,19,20,22,22,21,22,16,18,18,17,14,15,16,16</textarea>
                </div>
                <button class="update-btn" onclick="updateLineChart()">更新图表</button>
            </div>
        </div>
    </div>

    <div id="bar" class="tabcontent">
        <div class="chart-container">
            <div class="chart-wrapper">
                <h2>2013-2019财年阿里巴巴GMV</h2>
                <div id="barChart" style="width: 100%; height: 500px;"></div>
            </div>
            <div class="data-editor">
                <h3>数据编辑</h3>
                <div class="data-input">
                    <label for="barData">GMV数据:</label>
                    <textarea id="barData" rows="7">10770,16780,24440,30920,37670,48200,57270</textarea>
                </div>
                <button class="update-btn" onclick="updateBarChart()">更新图表</button>
            </div>
        </div>
    </div>

    <script>
        const colorThemes = {
            default: {
                bodyBg: '#FFFDD0',
                containerBg: 'white',
                editorBg: '#FFF9E6',
                borderColor: '#D2B48C',
                primaryColor: '#A78AFF',
                textColor: '#5C4033',
                tabBg: '#F5DEB3',
                chartColors: ['#89CFF0', '#A78AFF']
            },
            dark: {
                bodyBg: '#2D3748',
                containerBg: '#4A5568',
                editorBg: '#718096',
                borderColor: '#CBD5E0',
                primaryColor: '#805AD5',
                textColor: '#E2E8F0',
                tabBg: '#4A5568',
                chartColors: ['#63B3ED', '#68D391']
            },
            blue: {
                bodyBg: '#EBF8FF',
                containerBg: 'white',
                editorBg: '#E6FFFA',
                borderColor: '#90CDF4',
                primaryColor: '#3182CE',
                textColor: '#2D3748',
                tabBg: '#BEE3F8',
                chartColors: ['#3182CE', '#63B3ED']
            },
            green: {
                bodyBg: '#F0FFF4',
                containerBg: 'white',
                editorBg: '#C6F6D5',
                borderColor: '#9AE6B4',
                primaryColor: '#38A169',
                textColor: '#2F855A',
                tabBg: '#C6F6D5',
                chartColors: ['#38A169', '#68D391']
            },
            purple: {
                bodyBg: '#FAF5FF',
                containerBg: 'white',
                editorBg: '#E9D8FD',
                borderColor: '#D6BCFA',
                primaryColor: '#805AD5',
                textColor: '#553C9A',
                tabBg: '#E9D8FD',
                chartColors: ['#805AD5', '#9F7AEA']
            }
        };

        let currentTheme = 'default';
        let lineChart, barChart;

        function changeColorTheme(theme) {
            currentTheme = theme;
            const colors = colorThemes[theme];
            
            document.querySelectorAll('.color-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            document.body.style.backgroundColor = colors.bodyBg;
            document.querySelectorAll('.chart-container').forEach(el => {
                el.style.backgroundColor = colors.containerBg;
            });
            document.querySelectorAll('.data-editor').forEach(el => {
                el.style.backgroundColor = colors.editorBg;
                el.style.borderLeftColor = colors.borderColor;
            });
            document.querySelectorAll('.tab').forEach(el => {
                el.style.backgroundColor = colors.tabBg;
                el.style.borderColor = colors.borderColor;
            });
            document.querySelectorAll('h1, h2, h3').forEach(el => {
                el.style.color = colors.textColor;
            });
            document.querySelectorAll('.update-btn').forEach(el => {
                el.style.backgroundColor = colors.primaryColor;
            });
            
            updateChartColors(colors.chartColors);
        }

        function updateChartColors(colors) {
            if (lineChart) {
                lineChart.setOption({
                    color: colors,
                    series: [
                        { lineStyle: { width: 3 } },
                        { lineStyle: { width: 3 } }
                    ]
                }, true);
            }
            if (barChart) {
                barChart.setOption({
                    color: colors[0],
                    series: [{ itemStyle: { color: colors[0] } }]
                }, true);
            }
        }

        function openChart(evt, chartName) {
            document.querySelectorAll('.tabcontent').forEach(el => {
                el.style.display = 'none';
            });
            document.querySelectorAll('.tablinks').forEach(el => {
                el.classList.remove('active');
            });
            document.getElementById(chartName).style.display = 'block';
            evt.currentTarget.classList.add('active');
            
            if (chartName === 'line' && lineChart) lineChart.resize();
            if (chartName === 'bar' && barChart) barChart.resize();
        }

        function updateLineChart() {
            const maxTemp = document.getElementById('lineMaxTemp').value.split(',').map(Number);
            const minTemp = document.getElementById('lineMinTemp').value.split(',').map(Number);
            
            lineChart.setOption({
                series: [
                    { data: maxTemp },
                    { data: minTemp }
                ]
            });
        }

        function updateBarChart() {
            const data = document.getElementById('barData').value.split(',').map(Number);
            const labels = ["FY2013","FY2014","FY2015","FY2016","FY2017","FY2018","FY2019"];
            
            barChart.setOption({
                xAxis: { data: labels },
                series: [{ data: data }]
            });
        }

        // 页面加载完成后初始化ECharts
        document.addEventListener('DOMContentLoaded', loadECharts);
    </script>
</body>
</html>